<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1.0">
        <link href='https://fonts.googleapis.com/css?family=Oswald' rel='stylesheet'>
        <link href='https://fonts.googleapis.com/css?family=Montserrat' rel='stylesheet'>
        <title>Scoutmaster FTC</title>
        <link rel="stylesheet" href="styles.css">
    </head>

    <body>
        <!--nav-->

        <div class="nav">
            <center>
                <div class="navcontainer">
                    <div class="titlecontainer"><p class="title">Scoutmaster</p></div>
                    <div class="buttoncontainer">
                        <div class="buttonminicontainer">
                            <div class="accountbuttoncontainer"><button class="accountbutton"><img class="accountbuttonimg" id="accountbuttonimg" src="images/accountblack.png"></div>
                            <div class="darklighttogglecontainer"><button class="darklighttoggle" onclick="darkmodetoggle()"><img class="darklighttoggleimg" id="imgToToggle" src="images/moon.png"></button></div>
                        </div>
                    </div>
                </div>
                <div class="navdividercontainer">
                    <hr id="navdivider" class="navdivider">
                </div>
            </center>
        </div>


        <!--body-->

        <div class="mainbody">
            <div class="signedinmainbody">
            </div>

            <div class="signedoutmainbody">
                <div class="textcontainermainbody"><p class="generaltext">Elevate your scouting capabilities and always make the best alliance picks.</p></div>
                <div class="reasonscontainer">
                    <div class="reasonscontainermini">
                        <div class="reason1" id="reason1">
                            <div class="reasonimagecontainer"><img class="reasonimage" src="images/people.png"></div>
                            <div class="reasontextcontainer"><p class="reasontext">Share scouting data with teammates</p></div>
                        </div>
                        <div class="reason2" id="reason2">
                            <div class="reasonimagecontainer"><img class="reasonimage" src="images/calculator.png"></div>
                            <div class="reasontextcontainer"><p class="reasontext">Get accurate numbers for every team at every competition</p></div>
                        </div>
                        <div class="reason3" id="reason3">
                            <div class="reasonimagecontainer"><img class="reasonimage" src="images/handshake.png"></div>
                            <div class="reasontextcontainer"><p class="reasontext">Realtime alliance info</p></div>
                        </div>
                        <div class="reason4" id="reason4">
                            <div class="reasonimagecontainer"><img class="reasonimage" src="images/navigate.png"></div>
                            <div class="reasontextcontainer"><p class="reasontext">Easy to navigate UI</p></div>
                        </div>
                    </div>
                </div>

                <div class="signupbuttoncontainer">
                    <button id="signupbutton" onclick="goToLogIn()" class="signupbutton">Sign in</button>
                </div>
            </div>
        </div>


        <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script> <!--supabase-->
        <script>
            const SUPABASE_URL = 'https://tgptsuzheleshmtesbcx.supabase.co';
            const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InRncHRzdXpoZWxlc2htdGVzYmN4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4ODA3NDQsImV4cCI6MjA3MDQ1Njc0NH0.pNTxZbSUeyATBlssBIZDrTyn1E2fr8bvCQ4mP3OQ-JM';

            const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

            //dark mode toggle
            function darkmodetoggle(){
                const targetBody = document.body;
                const sunMoonImg = document.getElementById("imgToToggle");
                const accountButtonImg = document.getElementById("accountbuttonimg")
                const switchList = [document.getElementById("navdivider"), document.getElementById("reason1"), document.getElementById("reason2"), document.getElementById("reason3"), document.getElementById("reason4"), document.getElementById("signupbutton")]

                targetBody.classList.toggle("darkmode");
                if(targetBody.classList.contains("darkmode")){
                    document.cookie = "darklight=dark; path=/; max-age=31536000; SameSite=Lax; Secure";
                    sunMoonImg.src = "images/sun.png";
                    accountButtonImg.src = "images/accountwhite.png"
                    switchList.forEach(targetElement =>{
                        targetElement.classList.add(targetElement.id+"dark")
                        targetElement.classList.remove(targetElement.id)
                    })
                }else{
                    document.cookie = "darklight=light; path=/; max-age=31536000; SameSite=Lax; Secure";
                    sunMoonImg.src = "images/moon.png";
                    accountButtonImg.src = "images/accountblack.png"
                    switchList.forEach(targetElement =>{
                        targetElement.classList.remove(targetElement.id+"dark")
                        targetElement.classList.add(targetElement.id)
                    })
                }
            }

            
            //load specific cookie
            function getCookie(name) {
                const cookies = document.cookie.split('; ');
                for (let cookie of cookies) {
                    const [key, value] = cookie.split('=');
                    if (key === name) {
                    return value;
                    }
                }
                return null;
            }


            //loading cookies
            function loadcookies(){
                //loading dark theme pref cookie
                const targetBody = document.body;
                const theme = getCookie("darklight");

                if(theme == "dark"){
                    darkmodetoggle();
                }
            }

            window.onload = function(){
                loadcookies();
                useSessionData();
            }

            function goToLogIn(){
                window.location.href = "signup.html"
            }

            function useSessionData(){
                isUserLoggedIn().then((isLoggedIn)=>{
                    if(isLoggedIn){
                        alert("logged in")
                    }else{
                        alert("logged out")
                    }
                })
            }

            async function isUserLoggedIn() {
                const { data: { session }, error } = await supabase.auth.getSession();

                if (error) {
                    console.error("Session check failed:", error.message);
                    return false;
                }

                return !!session; 
            }

        </script>
    </body>
</html>
